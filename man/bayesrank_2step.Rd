% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BayeSRank_2step.R
\name{bayesrank_2step}
\alias{bayesrank_2step}
\title{bayesrank_2step: Two-Step Bias-Aware Bayesian Rank Aggregation}
\usage{
bayesrank_2step(
  rank_matrix,
  M_itrns = 5000,
  m_burn = 1000,
  init_W = NULL,
  step1_minbeta = -100,
  step1_maxbeta = 100,
  step1_Var_beta0 = 1,
  step1_Var_epsilon0 = 1,
  step1_a = 0.1,
  step1_b = 0.1,
  step1_c = 0.1,
  step1_d = 0.1,
  seed = NULL
)
}
\arguments{
\item{rank_matrix}{An \eqn{n \times n} matrix of observed rankings, where
\code{rank_matrix[i, j]} denotes the rank assigned by ranker \code{j}
to item \code{i}. Typically, the diagonal represents self-rankings.}

\item{M_itrns}{Integer. Number of MCMC iterations per stage (pilot and main).}

\item{m_burn}{Integer. Number of burn-in iterations to discard for posterior summaries.}

\item{init_W}{Optional \eqn{n \times n} matrix. If provided, used as the initial latent
utility matrix \code{W}. If \code{NULL}, an initial matrix is generated and reordered
according to the observed rankings.}

\item{step1_minbeta, step1_maxbeta}{Numeric scalars. Truncation bounds for bias parameters \code{beta_j}
in the pilot step.}

\item{step1_Var_beta0}{Numeric scalar. Initial variance for \code{beta_j} in the pilot step.}

\item{step1_Var_epsilon0}{Numeric scalar. Initial variance of error terms \code{epsilon_j} in the pilot step.}

\item{step1_a, step1_b, step1_c, step1_d}{Numeric scalars. Hyperparameters for inverse-gamma priors in the pilot step.}

\item{seed}{Optional integer. If set, ensures reproducibility of the MCMC runs.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages for each step.}
}
\value{
A list containing:
\describe{
\item{\code{preliminary}}{Posterior output from the pilot step with diffuse priors.}
\item{\code{final}}{Posterior output from the main chain using tuned priors.}
\item{\code{tuned_hyper}}{List of calibrated hyperparameters passed to the second step.}
}
}
\description{
This function implements a two-stage version of the BayeSRank algorithm.
The first stage runs a preliminary MCMC chain with diffuse priors to
empirically tune the prior bounds and hyperparameters. These estimates
are then used in the second stage, which runs a full posterior inference
using the calibrated priors. This two-step procedure improves stability and
reduces manual tuning.
}
\details{
The first step of \code{bayesrank_2step()} estimates posterior summaries using
weak priors. The output is then used to:
\itemize{
\item Estimate the posterior mean and standard deviation of \code{beta_j},
which define a 3-sigma truncation range for the second step;
\item Estimate the shape and rate of inverse-gamma priors on variance components
via moment-matching.
}

These empirical values are then passed into a second run of \code{\link{BayeSRank}}.
}
\examples{
set.seed(42)
n <- 5
rank_matrix <- matrix(sample(1:n, n*n, replace = TRUE), n, n)

out <- bayesrank_2step(
  rank_matrix = rank_matrix,
  M_itrns = 1000,
  m_burn = 200,
  verbose = TRUE,
  seed = 123
)

str(out$final$post_mean_mus)
out$tuned_hyper$minBeta

}
\seealso{
\code{\link{BayeSRank}} for the underlying single-chain rank aggregation algorithm.
}
